The code here is disgusting at the moment pls dont look
